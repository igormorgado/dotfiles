#!/bin/bash

statusbar=""

##############################
# DROPBOX
dstatus=$( dropbox status | head -n1 | tr "[:upper:]" "[:lower:]")
case "${dstatus}" in
	connec*)
		d="."
		;;
	star*)
		d="o"
		;;
	sync*)
		d="@"
		;;
	index*)
		d="i"
		;;
	"up to date")
		d="O"
		;;
	upload*)
		d="^"
		;;
	downlo*)
		d="v"
		;;
	*running*)
		d="X"
		;;
	*)
		d="${dstatus}"
		;;
esac
statusbar+="${d} "

##############################
# Check IDLE
checkidle_status="/var/run/checkidle/status" 
if [ -r "${checkidle_status}" ]; then
	CI=( $( cat ${checkidle_status} ) )
fi
printf -v c "%s,%s(%s)" "${CI[1]}" "${CI[2]}" "${CI[3]}"
statusbar+="${c} "

##############################
# Load average
l=$( cut -d " " -f 1-3 /proc/loadavg )
statusbar+="${l} "


echo "${statusbar}"
